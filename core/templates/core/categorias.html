{% extends "base.html" %}
{% load static %}

{% block title %}Categorías | PeM{% endblock %}

{% block content %}
<div class="container py-5">
  <h1 class="mb-4 text-center fw-bold text-primary">
    <i class="bi bi-tags"></i> Categorías
  </h1>

  {% for categoria, productos in destacados_list %}
    <div class="mb-5">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h3 class="h5 fw-semibold">{{ categoria.nombre }}</h3>
        <a href="{% url 'catalogo' %}?categoria={{ categoria.id }}" class="text-decoration-none small">
          Ver todos →
        </a>
      </div>

      <div class="row row-cols-2 row-cols-md-4 g-3">
        {% for p in productos %}
          <div class="col">
            <div class="card h-100 shadow-sm border-0">
              <img src="{{ p.imagen.url|default:'/static/images/placeholder.png' }}"
                   class="card-img-top" alt="{{ p.nombre }}">
              <div class="card-body">
                <h6 class="card-title text-truncate">{{ p.nombre }}</h6>
                {% if p.precio_oferta %}
                  <p class="mb-0">
                    <span class="text-danger fw-bold">{{ p.precio_oferta }} €</span>
                    <span class="text-muted text-decoration-line-through small">{{ p.precio }} €</span>
                  </p>
                {% else %}
                  <p class="fw-bold text-primary mb-0">{{ p.precio }} €</p>
                {% endif %}
              </div>
            </div>
          </div>
        {% empty %}
          <p class="text-muted small ps-3">No hay productos destacados en esta categoría.</p>
        {% endfor %}
      </div>
    </div>
  {% empty %}
    <div class="text-center text-muted py-5">
      <i class="bi bi-folder2-open display-3"></i>
      <p class="mt-3">No hay categorías disponibles.</p>
    </div>
  {% endfor %}
</div>
{% endblock %}
